# Anshin プラグイン概要

このドキュメントは、`/anshin/plugins` フォルダにあるプラグインの概要を説明します。これらのプラグインは、Anshin ドキュメントサイトの機能拡張や自動化を担っています。

---

## 1. generateAdminIndex

**目的：**
サイトビルド時に `index.html` ファイルを自動生成します。ステージング環境では、この `index.html` が Decap CMS へのエントリーポイントとなり、編集者がブラウザ上でコンテンツ管理インターフェースにアクセスできます。本番環境では、代わりにカスタム 404 Not Found ページが生成され、CMS へのアクセスを防ぎます。

**主なファイル：**
- `index.404.html`: 本番環境用のカスタム 404 ページ
- `index.cms.html`: ステージング用のCMSインターフェースページ
- `index.ts`: どちらのファイルを出力するか環境に応じて判定し、管理するスクリプト

**使い方：**
このプラグインは、ビルド環境（ステージング/本番）に応じて適切な管理用エントリーポイント（CMSまたは404）を生成します。これにより、CMSは本番環境では非公開となります。

---

## 2. netlifyCmsConfig

**目的：**
Decap（Netlify）CMS との連携のための設定やフィールド定義を管理します。サイトビルド時に、ドキュメント内の既存フォルダ構成からCMSコレクションを動的に生成します。これにより、ステージングブランチでフォルダが追加・削除された場合でも、Decap CMS 側で自動的に反映され、常に最新のドキュメント構成がCMSに表示されます。

**主なファイル：**
- `index.ts`: Netlify CMS の主要な設定ロジック（リポジトリ、ブランチ、認証、動的コレクション生成など）
- `netlifyCmsFields.ts`: CMSフィールドの型定義やヘルパー。Markdownドキュメントの構造やバリデーションを保証します。

**使い方：**
このプラグインは、Decap CMS を通じたMarkdownファイルのブラウザ編集、ドキュメント構造の整合性維持、CMSコレクションと実際のフォルダ構成の同期を実現します。

---

## プラグインの仕組み
- `/anshin/plugins` 内のプラグインは、ドキュメント管理・管理画面・CMSワークフローの自動化や拡張のために利用されます。
- これらはビルドプロセスの一部としてインポート・実行されたり、設定ファイルから参照されます。

## 参考リンク
- CMSの利用方法は [Decap CMS ドキュメント](https://decapcms.org/) を参照してください。
